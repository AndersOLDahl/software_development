<div id="admin-panel">
    <% if user_signed_in? %>
        <%= form_for @microsite, url: create_microsite_path do |f| %>
            <% flash.each do |key, value| %>
                <%= content_tag :div, value, class: "flash #{key}" %>
            <% end %>
            <p>
            <%= f.label :site %><br>
            <%= f.text_field :site %>
            </p>

            <p>
            <%= f.label :field_lat %><br>
            <%= f.text_field :field_lat %>
            </p>

            <p>
            <%= f.label :field_lon %><br>
            <%= f.text_field :field_lon %>
            </p>

            <p>
            <%= f.label :location %><br>
            <%= f.text_field :location %>
            </p>

            <p>
            <%= f.label :country %><br>
            <%= f.country_select :country %>
            </p>

            <p>
            <%= f.label :state_province %><br>
            <%= f.text_field :state_province %>
            </p>

            <p>
            <%= f.label :biomimic %><br>
            <%= f.select :biomimic, options_for_select(["Barnacle", "Coral", "Mussel", "Sea Star"]) %>
            </p>

            <p>
            <%= f.label :zone %><br>
            <%= f.text_field :zone %>
            </p>

            <p>
            <%= f.label :sub_zone %><br>
            <%= f.select :sub_zone, options_for_select(["Backreef", "Forereef", "High", "High Mid", "Lagoon", "Low", "Low Mid", "Mid", "Terr"])  %>
            </p>

            <p>
            <%= f.label :wave_exp %><br>
            <%= f.select :wave_exp, options_for_select(["Exposed", "Intermediate",         "Moderately Exposed", "Protected"]) %>
            </p>

            <p>
            <%= f.label :tide_height %><br>
            <%= f.text_field :tide_height %>
            </p>

            <p>
            <%= f.submit %>
            </p>


        <% end %>
    <% end %>
</div>

<header>
    <h1>Helmuth Lab Database</h1>

    <% if user_signed_in? %>
        <div id="admin-login" class="logged-in">
            <span id="current-user"><%= current_user.email %></span>
            <%= link_to('Log Out', destroy_user_session_path, method: :delete, class: "generic-button") %>
        </div>
    <% else %>
        <div id="admin-login" class="logged-out">
            <%= link_to('Log In', new_user_session_path, class: "generic-button") %>
        </div>
    <% end %>
</header>

<div id="map" data-microsites="<%= @hash.to_json %>"></div>

<div id="filters">
    <%= select(:microsite, :site, Microsite.all.collect {|m| m.site}.uniq.sort, { include_blank: 'Site' }) %>
    <%= select(:microsite, :country, Microsite.all.collect {|m| m.country}.uniq.sort, { include_blank: 'Country'}) %>
    <%= select(:microsite, :state_province, Microsite.all.collect {|m| m.state_province}.uniq.sort, { include_blank: 'State/Province' }) %>
    <%= select(:microsite, :zone, Microsite.all.collect {|m| m.zone}.uniq.sort, { include_blank: 'Zone' }) %>
    <%= select(:microsite, :sub_zone, Microsite.all.collect {|m| m.sub_zone}.uniq.sort, { include_blank: 'SubZone' }) %>
</div>

<div id="export-options">
    <%= link_to('Export CSV', {controller: "readings", format: :csv}, class: "generic-button")%>
</div>
